@model WebApplication1.Models.MovieList

@{
    Layout = null;
}
<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    @*<link rel="stylesheet" href="/resources/demos/style.css">*@
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script>


        $(document).ready(function () {
            //var url = "";
            //$('div#thedialog').dialog({ autoOpen: false })
            $('#thelink').click(function () { $('div#thedialog').dialog('open'); });
            $('.a').click(function () {
                $('#dialog').dialog("option", "title", $("#movieName").val() + "  Trailer");
                //$('#dialog').title = $("#movieName").val(movieName);
                $('#dialog').dialog('open');


            });
            $('#dialog').on('dialogclose', function (event) {
                var iframes = document.querySelectorAll('iframe');
                if (iframes.length != 0) {
                    iframes[0].src = '';

                    delete iframes;
                }

            });
            $('#dialogMovie').on('dialogclose', function (event) {
                var iframes = document.querySelectorAll('iframe');
                if (iframes.length != 0) {
                    iframes[0].src = '';

                    delete iframes;
                }
            });




            $('#closeButton').click(function () { $('#dialog').dialog('close'); });

            $('#playMovieButton').click(function () {
                $('#dialog').dialog('close');
                $('#dialogMovie').dialog("option", "title", $("#movieName").val());
                if ($('#movieName').val() == "Higurashi No Naku Koro Ni") {
                    if ($('#autoPlaySetting').val() == 'Y') {
                        $('#dialogMovie').append("<video width='1280' height='720' title=" + $("#movieName").val() + "id = 'moviePlayer' controls autoplay >" +
                            "<source src='C:\\Users\\dparh\\Desktop\\Higurashi_no_Nakukoroni_01.mp4' type='video/mp4'>" +
                            "<source src='movie.ogg' type='video/ogg'> Your browser does not support the video tag.</video>");
                    }
                    else {
                        $('#dialogMovie').append("<video width='1280' height='720' title=" + $("#movieName").val() + "id = 'moviePlayer' controls >" +
                            "<source src='C:\\Users\\dparh\\Desktop\\Higurashi_no_Nakukoroni_01.mp4' type='video/mp4'>" +
                            "<source src='movie.ogg' type='video/ogg'> Your browser does not support the video tag.</video>");
                    }

                }
                else {
                    if ($('#autoPlaySetting').val() == 'Y') {
                        $('#dialogMovie').append("<video width='1280' height='720' title=" + $("#movieName").val() + "id = 'moviePlayer' controls autoplay>" +
                            "<source src='C:\\Users\\dparh\\Desktop\\Kikoushi_Enma_-_01.mp4' type='video/mp4'>" +
                            "<source src='movie.ogg' type='video/ogg'> Your browser does not support the video tag.</video>");
                    }
                    else {
                        $('#dialogMovie').append("<video width='1280' height='720' title=" + $("#movieName").val() + "id = 'moviePlayer' controls >" +
                            "<source src='C:\\Users\\dparh\\Desktop\\Kikoushi_Enma_-_01.mp4' type='video/mp4'>" +
                            "<source src='movie.ogg' type='video/ogg'> Your browser does not support the video tag.</video>");
                    }

                }


                $('#dialogMovie').dialog('open');
            });

            $(function () {
                $('#dialog').dialog({
                    autoOpen: false,
                    width: 1300,
                    height: 800,
                    resizable: false,
                    modal: true
                });

                $('#dialogMovie').dialog({
                    autoOpen: false,
                    width: 1300,
                    height: 800,
                    resizable: false,
                    modal: true
                });

                $('#trailerButton').click(function () {
                    //$('#dialog').dialog({ title: $("#movieName").val(movieName); });
                    //$("#dialog").text = ;

                    $('#dialog').append($("#urlLink").val());



                });

                $('.modal').click(function () {
                    $('#dialog').load(this.href, function () {
                        $(this).dialog('open');
                    });
                    return false;
                });
            });
        });



        function openit(tagId, movieName, movieID, autoPlaySetting) {

            $("#urlLink").val("<iframe id='cartoonVideo' width='1280' height='720' src='" + tagId + "' frameborder='1'</iframe>");
            $("#movieName").val(movieName);
            $("#movieIDHidden").val(movieID);
            $("#autoPlaySetting").val(autoPlaySetting);
        }




    </script>
    <title>Browse</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="~/css/site.css" />
</head>

<body>
    <h1>Browse</h1>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a asp-area="" asp-controller="Home" asp-action="Index" class="navbar-brand"> Yuri01 </a>
            </div>
            <form asp-action="AccountManagement" asp-controller="Home" method="post">
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a asp-area="" asp-controller="Home" asp-action="Browse">Browse</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="Favorites">Favorites</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="Settings">Settings</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="AccountManagement">Account Management</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut">Log Out</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="Theatre"></a>Theatre</li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut"></a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="LogOut">Ver 1.4</a></li>
                    </ul>
                </div>
            </form>
        </div>
    </nav>
    <input type="hidden" id="urlLink" />
    <input type="hidden" id="movieName" />
    <input type="hidden" id="autoPlaySetting" />
    <div align="center">

        <div id="dialog" title="Trailer">
            <form asp-action="SaveToFavorites" asp-controller="Home" method="post">
                @Html.HiddenFor(m => m.listOfMovies.ElementAt(0).movieID, new { id = "movieIDHidden" })
                <input type="button" id="closeButton" value="Close" />

                <input type="button" id="trailerButton" value="Play Trailer" />

                <input type="submit" id="addToFavorites" value="Add To Favorites" />

                <input type="button" id="playMovieButton" value="Play Movie" />

            </form>
        </div>

        <div id="dialogMovie" title="Movie">


        </div>




        @for (int v = 0; v < Model.listOfGenres.Count; v++)
        {
            <table id="movieTable">
                <tr>
                    <td><h1>@Html.DisplayFor(x => x.listOfGenres.ElementAt(v).genreName)</h1></td>


                </tr>
                <tr>

                    @for (int i = 0; i < Model.listOfMovies.Count; i++)
                    {
                        if (Model.listOfMovies[i].movieGenreID == Model.listOfGenres[v].movieGenreID)
                        {
                            <td style="height:auto; max-width:300px;overflow:hidden; padding:25px; margin:75px; " class="a" onclick="openit('@Model.listOfMovies.ElementAt(i).MovieTrailerURL', '@Model.listOfMovies.ElementAt(i).movieName', '@Model.listOfMovies.ElementAt(i).movieID', '@Model.autoPlay')"><img src="~/images/@Model.listOfMovies.ElementAt(i).movieImageName" /></td>
                        }

                    }


                </tr>
            </table>

        }

    </div>

</body>
</html>